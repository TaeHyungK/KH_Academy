<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>File</title>
<script type="text/javascript">
   window.onload=function(){
	   //파일을 선택할떄 
	   document.getElementById('file').onchange = function(event){
		   //선택한 파일의 정보를 갖는 파일 객체 취득
		   var file = this.files[0];
		   
		   //파일명 구하기
		   alert(file.name +'을 선택하였습니다');
	   };
	   //읽기 버튼을 클릭할때
	   document.getElementById('btnStart').onclick = function(){
		   readProcess();
	   };
	   
	   
   };
	   function readProcess(){
		//선택한 파일에 대한 정보를 제공하는 파일 객체 구하기
		var file = document.getElementById('file').files[0];
		if(!file){//if(file ==undefined)
			alert('파일을 선택하세요')
			return;
		}
		
	   document.getElementById('filename').textContent = file.name;
	   document.getElementById('filesize').textContent = '('+file.size+'bytes)';
	   document.getElementById('filetype').textContent = file.type;
	   document.getElementById('filedate').textContent = file.lastModifiedDate.toLocaleString();
		
		//인코딩 방식 지정
		var encodeList = document.getElementById('encoding');
		var encoding = encodeList.options[encodeList.selectedIndex].value;
		
		//파일 읽기 기능을 제공하는 FileReader 객체 생성
		var reader = new FileReader();
	    //선택한 파일을 읽어서 문자열로 저장
	    reader.readAsText(file,encoding);
	    
	    //정상적으로 파일을 읽어 들였을 경우
	    reader.onload = function(){
	    	var disp = document.getElementById('contents');
	    	disp.textContent = reader.result;//읽어들인 내용
	    };
	    //읽는 도중 에러가 발생한 경우
	    reader.onerror = function(){
	    	/*
	    	  NOT_FOUND_ERR : 1 파일을 찾을수 없을때
	    	  SECURITY_ERR : 2 웹 에플리케이션에서 사용하기엔 보안상 좋지 않다고 판단했을때
	    	  ABORT_ERR  :  3 파일읽기 중단
	    	  NOT_READABLE_ERR : 4 파일읽기 권한이 없을떄
	    	  ENCODING_ERR  : 5 data URL 길이가 URL 길이의 상한을 초과할떄
	    	*/
	    	if(reader.error.code === reader.error.NOT_READABLE_ERR){
	    		alert('파일읽기 권한이 없습니다')
	    	}else if(reader.error.code === reader.error.ABORT_ERR){
	    		alert('파일 읽기 중지됬습니다.')
	    	}else{
	    		alert('파일 읽기가 실패했습니다')
	    	}
	    };
	    
	   }
	   
</script>
</head>
<body>

    <h2>현재 시스템의 파일 읽기</h2>
    <input type="file" id="file" accept="text/*">
    <select id="encoding">
        <option>EUC-KR</option>
        <option>UTF-8</option>
    </select>
    <button id="btnStart">읽기</button>
    <br>
    <br>
    <div>
       <span id="filename">파일명</span>
       <span id="filesize">파일크기</span>
       <span id="filetype">파일타입</span>
       <span id="filedate">파일의 마지막 갱신 일시</span>
    </div>
    <textarea rows="10" cols="50" id="contents"></textarea>
    

</body>
</html>